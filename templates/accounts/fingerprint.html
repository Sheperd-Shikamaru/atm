{% extends 'core/base.html' %} 
{% block head_title %}Banking System{% endblock%} 
{% block content %}

<body>
  <h1 class="mb-3 mt-10">
    Please place your finger on the Finger Print sensor
  </h1>

  <div style="display: flex; justify-content: center">
    <img src="https://th.bing.com/th/id/OIP.iEB26aXE4ClDEpKGvD_vbAHaER?pid=ImgDet&rs=1"/>
  </div>

  <div class="mt-5" style="display: flex; justify-content: center; color: black;">
    <div id="message"></div>
  </div>

  <form id="fingerprint-form" method="post">
    {% csrf_token %}
    <input type="text" id="location" name="location" value="11" hidden />
    <div class="mt-5" style="display: flex; justify-content: center">
      <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">Enroll Fingerprint</button>
    </div>
  </form>

</body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  $(document).ready(function () {
    $("#fingerprint-form").submit(function (event) {
      event.preventDefault();

      var location = $("#location").val();

      // Using SSE to receive real-time updates
      url = "/transactions/fingerprint_register/"
      var eventSource = new EventSource(url);
      eventSource.onmessage = function(event) {
        $("#message").append(event.data + "<br>");
      };

      eventSource.onclose = function() {
        $("#message").append("Fingerprint registration process completed.<br>");
        eventSource.close();
      };
      
     
    });
  });
</script>

{% endblock %}
